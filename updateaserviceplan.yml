---
- name: update a servicePlan
  hosts: localhost
  connection: local
  vars:
    morpheus_appliance_url: https://api.gomorpheus.com/api/service-plans
    morpheus_api_token: fa74c6c7-aee5-4389-906b-51967bd616b0
  tasks:
    - name: polaris
      uri:
        url: "{{ morpheus_appliance_url}}"
        headers:
            Authorization: "BEARER {{ morpheus_api_token }}"
        method: POST
        body:
          servicePlan:
            name: create_new_serviceplan
            code: create_new_serviceplan
            description:
            maxStorage: 102400
            config:
              storageSizeType: gb
              memorySizeType: mb
              ranges:
                minStorage: 8192
                maxStorage: 102400
                minMemory: 8192
                maxMemory: 102400
                minCores: 1
                maxCores: 4
            maxMemory: 102400
            maxCores: 4
            maxDisks: 5
            customCores: true
            customMaxStorage: true
            customMaxDataStorage: true
            customMaxMemory: true
            sortOrder: 1
            priceSets:
              id: 170
            addVolumes: true
            provisionType:
              id: 1
            visibility: private
            permissions:
              resourcePermissions:
                all: true
                sites:
                   id: 2
                   id: 4
              tenantPermissions:
                accounts: polaris
        validate_certs: false
        body_format: json
        force_basic_auth: yes
        return_content: true
      register: updated_service_plans
      
      -debug:
         msg: "{{ updated_service-plans}}"
